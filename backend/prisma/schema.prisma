generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["views"]
}

datasource db {
  provider = "sqlite"
}

model Account {
  id                    String   @id
  accountId             String
  providerId            String
  userId                String
  accessToken           String?
  refreshToken          String?
  idToken               String?
  accessTokenExpiresAt  DateTime?
  refreshTokenExpiresAt DateTime?
  scope                 String?
  password              String?
  createdAt             DateTime
  updatedAt             DateTime
  user                  User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model Session {
  id        String   @id
  expiresAt DateTime
  token     String   @unique
  createdAt DateTime
  updatedAt DateTime
  ipAddress String?
  userAgent String?
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model User {
  id            String      @id @default(cuid())
  username      String?     @unique
  name          String?
  email         String?     @unique
  googleId      String?     @unique
  emailVerified DateTime?
  image         String?
  password      String?
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
  staffId       Int?
  roleId        Int         @default(1)
  userStatus    String      @default("active")
  accounts      Account[]
  sessions      Session[]
  staff         Staff[]
  role          Role        @relation(fields: [roleId], references: [id], onDelete: Cascade)
  viewStaff     viewStaff[]
}

model Role {
  id    Int    @id @default(autoincrement())
  name  String @unique
  users User[]
}

model Staff {
  id            Int             @id @default(autoincrement())
  StaffName     String
  AgentName     String
  StaffCategory String
  Department    String
  PostUnit      String
  ManagerName   String
  ManagerTitle  String
  ManagerEmail  String
  userId        String
  leaveRequests LeaveRequest[]
  user          User            @relation(fields: [userId], references: [id])
  contracts     StaffContract[] @relation("staffToContracts")
  staffFiles    staffFiles[]
}

model CalendarMaster {
  CalendarDate DateTime @id
  WeekDayName  String?
  Year         Int
  Month        Int
}

model PublicHoliday {
  StartDate DateTime @id
  EndDate   DateTime
  Summary   String?
}

model CalendarVacation {
  id             Int          @id @unique @default(autoincrement())
  VacationDate   DateTime
  ChargeableDay  Decimal
  LeaveRequestId Int
  leaveRequest   LeaveRequest @relation(fields: [LeaveRequestId], references: [id], onDelete: Cascade)
}

model StaffContract {
  id                Int            @id @default(autoincrement())
  ContractStartDate DateTime
  ContractEndDate   DateTime
  AnnualLeave       Int
  staffId           Int
  IsActive          Boolean        @default(false)
  IsArchived        Boolean        @default(false)
  LeaveRequest      LeaveRequest[]
  staff             Staff          @relation("staffToContracts", fields: [staffId], references: [id])
}

model LeaveRequest {
  id               Int                @id @default(autoincrement())
  leavePeriodStart DateTime
  AMPMStart        String
  leavePeriodEnd   DateTime?
  AMPMEnd          String?
  leaveDays        Float
  dateOfReturn     DateTime
  staffSignDate    DateTime
  leavePurpose     String?
  leaveType        String
  fileId           Int
  staffId          Int
  contractId       Int                @map("contractId")
  IsArchived       Boolean            @default(false)
  calendarVacation CalendarVacation[]
  contract         StaffContract      @relation(fields: [contractId], references: [id])
  staffFile        staffFiles         @relation(fields: [fileId], references: [id], onDelete: Cascade)
  staff            Staff              @relation(fields: [staffId], references: [id])
}

model staffFiles {
  id           Int            @id @default(autoincrement())
  filePath     String
  fileType     String
  staffId      Int
  LeaveRequest LeaveRequest[]
  staff        Staff          @relation(fields: [staffId], references: [id])
}

model Verification {
  id         String    @id
  identifier String
  value      String
  expiresAt  DateTime
  createdAt  DateTime?
  updatedAt  DateTime?
}

view viewCalendarTimeSheet {
  ID                     Int     
  CalendarDate           DateTime
  CalendarDateStr        String?
  WeekDayName            String?
  Year                   Int?
  Month                  Int?
  VacationChargable      Float
  PublicHolidayChargable Float
  HolidaySummary         String?
  LeaveRequestId         Int?
  staffId                Int?
  contractId             Int
}

view viewEvents {
  ID               Int     
  leavePeriodStart DateTime
  leavePeriodEnd   DateTime?
  StartDateStr     String
  WeekDayName      String
  Year             Int
  Month            Int
  HolidaySummary   String?
  eventType        String?
  EndDateStr       String?
  dateOfReturn     DateTime?
  ReturnDateStr    String?
  AMPMStart        String?
  AMPMEnd          String?
  staffId          Int?
  leaveType        String?
  LeaveRequestId   Int?
  leaveDays        Float?
  contractId       Int?
  IsArchived       Boolean
}

view viewStaff {
  StaffId           Int
  StaffName         String
  AgentName         String
  StaffCategory     String
  Department        String
  PostUnit          String
  ManagerName       String
  ManagerTitle      String
  ManagerEmail      String
  userId            String
  ContractStartDate DateTime
  ContractEndDate   DateTime
  AnnualLeave       Int
  contractId        Int
  user              User     @relation(fields: [userId], references: [id])
}

view viewUserRole {
  userId     String?
  username   String?
  name       String?
  email      String?
  userStatus String?
  roleId     Int?
  roleName   String?
}
