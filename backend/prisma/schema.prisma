generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["views"]
}

datasource db {
  provider = "sqlite"
}

model Account {
  id                 String    @id
  userId             String
  providerType       String
  providerId         String
  providerAccountId  String
  refreshToken       String?
  accessToken        String?
  accessTokenExpires DateTime?
  createdAt          DateTime  @default(now())
  updatedAt          DateTime
  user               User      @relation(fields: [userId], references: [id])

  @@unique([providerId, providerAccountId])
}

model Session {
  id           String   @id
  userId       String
  expires      DateTime
  sessionToken String   @unique
  accessToken  String   @unique
  createdAt    DateTime @default(now())
  updatedAt    DateTime
  user         User     @relation(fields: [userId], references: [id])
}

model User {
  id            String      @id @default(cuid())
  username      String?     @unique
  name          String?
  email         String?     @unique
  emailVerified DateTime?
  image         String?
  password      String
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
  staffId       Int?
  roleId        Int         @default(1)
  userStatus    String      @default("active")
  accounts      Account[]
  sessions      Session[]
  staff         Staff[]
  role          Role        @relation(fields: [roleId], references: [id], onDelete: Cascade)
  viewStaff     viewStaff[]
}

model Role {
  id    Int    @id @default(autoincrement())
  name  String @unique
  users User[]
}

model Staff {
  id            Int             @id @default(autoincrement())
  StaffName     String
  AgentName     String
  StaffCategory String
  Department    String
  PostUnit      String
  ManagerName   String
  ManagerTitle  String
  ManagerEmail  String
  userId        String
  leaveRequests LeaveRequest[]
  user          User            @relation(fields: [userId], references: [id])
  contracts     StaffContract[] @relation("staffToContracts")
  staffFiles    staffFiles[]
}

model CalendarMaster {
  CalendarDate DateTime @id
  WeekDayName  String?
  Year         Int
  Month        Int
}

model PublicHoliday {
  StartDate DateTime @id
  EndDate   DateTime
  Summary   String?
}

model CalendarVacation {
  id             Int          @id @unique @default(autoincrement())
  VacationDate   DateTime
  ChargeableDay  Decimal
  LeaveRequestId Int
  leaveRequest   LeaveRequest @relation(fields: [LeaveRequestId], references: [id], onDelete: Cascade)
}

model StaffContract {
  id                Int            @id @default(autoincrement())
  ContractStartDate DateTime
  ContractEndDate   DateTime
  AnnualLeave       Int
  staffId           Int
  IsActive          Boolean        @default(false)
  IsArchived        Boolean        @default(false)
  LeaveRequest      LeaveRequest[]
  staff             Staff          @relation("staffToContracts", fields: [staffId], references: [id])
}

model LeaveRequest {
  id               Int                @id @default(autoincrement())
  leavePeriodStart DateTime
  AMPMStart        String
  leavePeriodEnd   DateTime?
  AMPMEnd          String?
  leaveDays        Float
  dateOfReturn     DateTime
  staffSignDate    DateTime
  leavePurpose     String?
  leaveType        String
  fileId           Int
  staffId          Int
  contractId       Int                @map("contractId")
  IsArchived       Boolean            @default(false)
  calendarVacation CalendarVacation[]
  contract         StaffContract      @relation(fields: [contractId], references: [id])
  staffFile        staffFiles         @relation(fields: [fileId], references: [id], onDelete: Cascade)
  staff            Staff              @relation(fields: [staffId], references: [id])
}

model staffFiles {
  id           Int            @id @default(autoincrement())
  filePath     String
  fileType     String
  staffId      Int
  LeaveRequest LeaveRequest[]
  staff        Staff          @relation(fields: [staffId], references: [id])
}

model VerificationRequest {
  id         String   @id
  identifier String
  token      String   @unique
  expires    DateTime
  createdAt  DateTime @default(now())
  updatedAt  DateTime

  @@unique([identifier, token])
}

/// The underlying view does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
view viewCalendarTimeSheet {
  ID                     Unsupported("")?
  CalendarDate           DateTime
  CalendarDateStr        Unsupported("")?
  WeekDayName            String?
  Year                   Int?
  Month                  Int?
  VacationChargable      Unsupported("")?
  PublicHolidayChargable Unsupported("")?
  HolidaySummary         Unsupported("")?
  LeaveRequestId         Int?
  staffId                Int?
  contractId             Unsupported("")
}

view viewEvents {
  ID               Unsupported("")
  leavePeriodStart DateTime
  leavePeriodEnd   DateTime?
  StartDateStr     Unsupported("")
  WeekDayName      String
  Year             Int
  Month            Int
  HolidaySummary   Unsupported("")?
  eventType        Unsupported("")?
  EndDateStr       Unsupported("")?
  dateOfReturn     DateTime?
  ReturnDateStr    Unsupported("")?
  AMPMStart        String?
  AMPMEnd          String?
  staffId          Int?
  leaveType        String?
  LeaveRequestId   Int?
  leaveDays        Unsupported("")?
  contractId       Int
  IsArchived       Unsupported("")?
}

view viewStaff {
  StaffId           Int
  StaffName         String
  AgentName         String
  StaffCategory     String
  Department        String
  PostUnit          String
  ManagerName       String
  ManagerTitle      String
  ManagerEmail      String
  userId            String
  ContractStartDate DateTime
  ContractEndDate   DateTime
  AnnualLeave       Int
  contractId        Int
  user              User     @relation(fields: [userId], references: [id])
}

view viewUserRole {
  userId     String?
  username   String?
  name       String?
  email      String?
  userStatus String?
  roleId     Int?
  roleName   String?
}
